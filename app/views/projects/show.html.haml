- content_for :title do
  = @project.title

.row{style: 'padding-bottom: 20px;'}
  .col-md-6
    - if @previous_project
      = button_to 'Previous', project_path(@episode, @previous_project), :id => "previous_link", :method => :get, :class => "btn btn-default btn-xs pull-left", :title=> "Try pressing 'j' on your keyboard.."
  .col-md-6
    - if @next_project
      = button_to 'Next', project_path(@episode, @next_project), :id => "next_link", :method => :get, :class => "btn btn-default btn-xs pull-right", :title => "Try pressing 'k' on your keyboard.."
.row
  .col-md-9
    .page-header.media
      .pull-left
        .img-wrapper
          = image_tag @project.avatar.url(:thumb), width: '32'
          = @project.title
          %br
          %small
            = render :partial => "projects/state_name", :locals => {:project =>  @project }
            by
            = link_to user_path(@project.originator) do
              = @project.originator.name
            = render :partial => "projects/like_button", :locals => {:project =>  @project }
        %span.help-block
          %small
            = render :partial => "projects/info", :locals => {:project => @project }
  .col-md-3
    - if current_user
      = render partial: 'projects/project_watch', locals: {project: @project, episode: @episode}

.row
  .col-sm-8.project-style
    :markdown
      #{ emojify @project.description }
  .col-sm-4
    .row
      .col-sm-12
        .text-right
          = render :partial => "projects/file_buttons", :locals => {:project =>  @project }
    .row
      .col-sm-12
        %h4
          - if @project.users.empty?
            No
          Hackers:
        .well.well-sm#hackers
          = render partial: 'hackers'
        - unless @project.aasm_state == "invention"
          %p#membership_buttons.pull-right
            = render partial: 'membership_buttons'
          .clearfix
    .row
      .col-sm-12
        %h4
          Looking for mad skills in:
        %p
          - if @project.keywords.empty?
            Nothing? Add some keywords!
          - else
            = render :partial => "keywords/show", :locals => {:keywords =>  @project.keywords }
          -if  @project.originator == current_user or @project.users.include? current_user
            = render :partial => "keywords/new", :locals => {:what => @project }
    .row
      .col-sm-12
        %h4
          This project is part of:
        %p#episode_list
          = render partial: 'episode_list'
        .btn-group.pull-right
          %button.btn.btn-success.dropdown-toggle{"data-toggle" => "dropdown", :type => "button"}
            %i.fa.fa-plus
            Add Hackweek
            %span.caret
          %ul.dropdown-menu{:role => "menu"}
            - Episode.all.reverse.each do |episode|
              %li{:role => "presentation"}
                = link_to(truncate(episode.name, length: 50), episode_project_path(:episode_id => episode.id), method: :post, remote: true)
        .clearfix
    .row
      .col-sm-12
        %h4
          Activity
          %span.pull-right
            = render :partial => "updates/show_all_modal", :locals => { :updates => @project.updates }
        %ul
        - @project.updates.reverse.first(5).each do |update|
          %li
            = render :partial => "updates/show", :locals => { :update => update }
%br
.row
  .col-sm-8#comments_section
    %h4 Comments
    - if @project.comments.present?
      %ul.media-list
        = render :partial => 'comments/comment', :collection => @project.comments
    - else
      %p Be the first to comment!
  .col-sm-4
    .col-sm-11#similar_projects
      %h4 Similar Projects
      - if @similar_projects.present?
        = render :partial => 'similar_projects', collection: @similar_projects, as: :project
      - else
        %p This project is one of its kind!
  .col-sm-12#comments_form_section
    %p
      - if current_user
        = render partial: 'comments/form', locals: { comment: @new_comment, parent: @project, id: rand(36**10).to_s(36).upcase[0,5] }

= render partial: 'comments/reply_modal'

- content_for :script do
  :javascript
    Mousetrap.bind('j', function() { $('#previous_link').click(); });
    Mousetrap.bind('k', function() { $('#next_link').click(); })
    $('textarea').atwho({at:"@", 'data':#{raw @username_array}});
